---
gem: actionpack
cve: 2021-44528
ghsa: qphc-hf5q-v8fc
url: https://groups.google.com/g/ruby-security-ann/c/vG9gz3nk1pM/m/7-NU4MNrDAAJ?utm_medium=email&utm_source=footer
title: Open Redirect in actionpack
date: 2021-12-14
description: |-
  Specially crafted "X-Forwarded-Host" headers in combination with certain
  "allowed host" formats can cause the Host Authorization middleware in Action
  Pack to redirect users to a malicious website.

  Impacted applications will have allowed hosts with a leading dot. For example,
  configuration files that look like this:

  ```
  config.hosts <<  '.EXAMPLE.com'
  ```

  When an allowed host contains a leading dot, a specially crafted Host header
  can be used to redirect to a malicious website.

  This vulnerability is similar to CVE-2021-22881 and CVE-2021-22942.

  Releases
  --------
  The fixed releases are available at the normal locations.

  Patches
  -------
  To aid users who aren't able to upgrade immediately we have provided patches for
  the two supported release series. They are in git-am format and consist of a
  single changeset.

  * 6-0-host-authorzation-open-redirect.patch - Patch for 6.0 series
  * 6-1-host-authorzation-open-redirect.patch - Patch for 6.1 series
  * 7-0-host-authorzation-open-redirect.patch - Patch for 7.0 series

  Please note that only the 6.1.Z, 6.0.Z, and 5.2.Z series are supported at
  present. Users of earlier unsupported releases are advised to upgrade as soon
  as possible as we cannot guarantee the continued availability of security
  fixes for unsupported releases.
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-qphc-hf5q-v8fc
- type: CVE
  value: CVE-2021-44528
summary: Open Redirect in actionpack
description: |-
  Specially crafted "X-Forwarded-Host" headers in combination with certain
  "allowed host" formats can cause the Host Authorization middleware in Action
  Pack to redirect users to a malicious website.

  Impacted applications will have allowed hosts with a leading dot. For example,
  configuration files that look like this:

  ```
  config.hosts <<  '.EXAMPLE.com'
  ```

  When an allowed host contains a leading dot, a specially crafted Host header
  can be used to redirect to a malicious website.

  This vulnerability is similar to CVE-2021-22881 and CVE-2021-22942.

  Releases
  --------
  The fixed releases are available at the normal locations.

  Patches
  -------
  To aid users who aren't able to upgrade immediately we have provided patches for
  the two supported release series. They are in git-am format and consist of a
  single changeset.

  * 6-0-host-authorzation-open-redirect.patch - Patch for 6.0 series
  * 6-1-host-authorzation-open-redirect.patch - Patch for 6.1 series
  * 7-0-host-authorzation-open-redirect.patch - Patch for 7.0 series

  Please note that only the 6.1.Z, 6.0.Z, and 5.2.Z series are supported at
  present. Users of earlier unsupported releases are advised to upgrade as soon
  as possible as we cannot guarantee the continued availability of security
  fixes for unsupported releases.
severity: MODERATE
cvss:
  score: 0.0
  vectorString:
references:
- url: https://nvd.nist.gov/vuln/detail/CVE-2021-44528
- url: https://groups.google.com/g/ruby-security-ann/c/vG9gz3nk1pM/m/7-NU4MNrDAAJ?utm_medium=email&utm_source=footer
- url: https://github.com/rails/rails/commit/aecba3c301b80e9d5a63c30ea1b287bceaf2c107
- url: https://github.com/rails/rails/blob/v6.1.4.2/actionpack/CHANGELOG.md#rails-6142-december-14-2021
- url: https://github.com/advisories/GHSA-qphc-hf5q-v8fc
publishedAt: '2021-12-14T21:19:08Z'
withdrawnAt:
vulnerabilities:
- package:
    name: actionpack
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 6.1.0, <= 6.1.4.1"
  firstPatchedVersion:
    identifier: 6.1.4.2
- package:
    name: actionpack
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 6.0.0, <= 6.0.4.1"
  firstPatchedVersion:
    identifier: 6.0.4.2
