---
gem: sanitize
cve: 2018-3741
date: 2018-03-22
url: "https://groups.google.com/d/msg/rubyonrails-security/tP7W3kLc5u4/uDy2Br7xBgAJ"
title: XSS vulnerability in rails-html-sanitizer
description: |
  There is a possible XSS vulnerability in rails-html-sanitizer. This
  vulnerability has been assigned the CVE identifier CVE-2018-3741.

  Versions Affected:  1.0.3 or older.
  Not affected:       None.
  Fixed Versions:     1.0.4

  Impact
  ------
  There is a possible XSS vulnerability in rails-html-sanitizer.  The gem allows non-whitelisted
  attributes to be present in sanitized output when input with specially-crafted HTML fragments,
  and these attributes can lead to an XSS attack on target applications.

  This issue is similar to CVE-2018-8048 in Loofah.

  All users running an affected release should either upgrade or use one of the
  workarounds immediately.

  Releases
  --------
  The FIXED releases are available at the normal locations.

  Workarounds
  -----------
  There are no feasible workarounds for this issue.

  Patches
  -------
  To aid users who aren't able to upgrade immediately we have provided patches for
  the two supported release series. They are in git-am format and consist of a
  single changeset.

  * 1-0-sanitize_attributes.patch - Patch for 1.0 series

  Credits
  -------
  Thanks to Kaarlo Haikonen for reporting this issue and Mike Dalessio for providing the original fix in the Loofah gem. 
patched_versions:
  - ">= 1.0.4"
related:
  url:
    - https://github.com/rails/rails-html-sanitizer/commit/f3ba1a839a35f2ba7f941c15e239a1cb379d56ae
